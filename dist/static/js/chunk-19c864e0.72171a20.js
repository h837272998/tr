(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-19c864e0"],{"374e":function(t,e,i){"use strict";var s=i("a2a0"),n=i.n(s);n.a},"4b8d":function(t,e,i){"use strict";var s=i("5887"),n=i.n(s);n.a},5887:function(t,e,i){},"6c6a":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-container",{staticStyle:{"margin-top":"30px"}},[i("el-aside",{attrs:{width:"160px"}},[t._l(t.hrs,(function(e,s){return i("div",{key:e.id,staticClass:"friendListDiv",class:{currentChatFriend:t.currentFriend.id==e.id},on:{click:function(i){return t.toggleFriend(e)}}},[i("img",{staticClass:"userfaceImg",attrs:{src:e.avatar}}),t._v(" "),i("el-badge",{attrs:{"is-dot":null!=t.isDotMap.get("isDot#"+t.currentUsername+"#"+e.username)}},[t._v("\n            "+t._s(e.username))])],1)})),t._v(" "),i("div",{staticStyle:{"background-color":"#20a0ff",height:"1px",width:"160px"}})],2),t._v(" "),i("el-main",{staticStyle:{"padding-top":"0px","padding-bottom":"0px"}},[i("div",{ref:"chatDiv",staticClass:"chatDiv",staticStyle:{"background-color":"#F5F5F5"},attrs:{id:"chatDiv"}},[i("p",{directives:[{name:"show",rawName:"v-show",value:t.currentFriend.username,expression:"currentFriend.username"}],staticStyle:{"text-align":"center"}},[t._v("与\n            "),i("el-tag",{staticStyle:{"margin-left":"5px","margin-right":"5px"},attrs:{type:"primary",size:"small"}},[t._v(t._s(t.currentFriend.username)+"\n            ")]),t._v("\n            聊天中\n          ")],1),t._v(" "),t._l(t.msgList,(function(e){return[e.from==t.currentFriend.username?i("div",{staticStyle:{display:"flex","justify-content":"flex-start","align-items":"center","box-sizing":"border-box","flex-wrap":"wrap","padding-bottom":"8px"}},[i("img",{staticClass:"userfaceImg",staticStyle:{"border-radius":"10px"},attrs:{src:t.currentFriend.avatar}}),t._v(" "),i("div",{staticStyle:{"background-color":"#FFFFFF",display:"inline-flex","border-style":"solid","border-width":"1px","border-color":"#f1f1f1","border-radius":"4px",padding:"5px 8px 5px 8px","max-width":"400px","word-break":"break-all"}},[t._v("\n                "+t._s(e.msg)+"\n")])]):t._e(),t._v(" "),e.from!=t.currentFriend.username?i("div",{staticStyle:{display:"flex","justify-content":"flex-end","align-items":"center","box-sizing":"border-box","padding-bottom":"8px"}},[i("div",{staticStyle:{display:"inline-flex","border-style":"solid","border-width":"1px","border-color":"#f1f1f1","border-radius":"5px",padding:"5px 8px 5px 8px","margin-right":"3px","background-color":"#9eea6a","max-width":"400px","word-break":"break-all"}},[t._v("\n                "+t._s(e.msg)+"\n")]),t._v(" "),i("img",{staticClass:"userfaceImg",staticStyle:{"border-radius":"10px"},attrs:{src:t.currentAvatar}})]):t._e()]}))],2),t._v(" "),i("div",{staticStyle:{"text-align":"left","margin-top":"10px"}},[i("el-input",{staticStyle:{width:"600px"},attrs:{placeholder:"请输入内容",size:"mini",type:"textarea",autosize:""},model:{value:t.msg,callback:function(e){t.msg=e},expression:"msg"}}),t._v(" "),i("el-button",{staticClass:"sendBtn",attrs:{disabled:!t.currentFriend.id,size:"small",type:"primary"},on:{click:t.sendMsg}},[i("i",{staticClass:"fa fa-send",staticStyle:{"margin-right":"15px"}}),t._v("发送\n          ")])],1)])],1)],1)},n=[],r=i("c24f"),a=i("ecea"),o={data:function(){return{hrs:[],msg:"",currentUsername:this.$store.getters.username,currentAvatar:this.$store.getters.avatar,currentFriend:{id:"",username:"",avatar:""}}},components:{FaceInput:a["a"]},computed:{msgList:{get:function(){return this.$store.state.char.msgList}},isDotMap:{get:function(){return this.$store.state.char.isDotMap}}},watch:{msgList:function(){document.getElementById("chatDiv").scrollTop=document.getElementById("chatDiv").scrollHeight}},mounted:function(){this.currentFriend.id=this.$route.query&&this.$route.query.id,this.currentFriend.username=this.$route.query&&this.$route.query.username,this.currentFriend.avatar=this.$route.query&&this.$route.query.avatar,this.loadHrs(),this.updateChatDiv()},methods:{sendMsg:function(){var t=this.$store.getters.username+"#"+this.currentFriend.username;console.info("当前key",t);var e=window.localStorage.getItem(t);if(console.info({msg:this.msg,from:this.$store.state.user.username}),null==e)e=[],e.push({msg:this.msg,from:this.$store.state.user.username}),window.localStorage.setItem(t,JSON.stringify(e));else{var i=JSON.parse(e);i.push({msg:this.msg,from:this.$store.getters.username}),window.localStorage.setItem(t,JSON.stringify(i))}this.$store.state.char.stomp.send("/ws/chat",{},this.msg+";"+this.currentFriend.username),this.msg="",this.updateChatDiv()},updateChatDiv:function(){var t=window.localStorage.getItem(this.$store.getters.username+"#"+this.currentFriend.username);null==t?this.$store.commit("char/updateMsgList",[]):this.$store.commit("char/updateMsgList",JSON.parse(t))},toggleFriend:function(t){t!==this.currentFriend&&(this.currentFriend=t,this.$store.commit("char/updateCurrentFriend",t),this.updateChatDiv(),this.$store.commit("char/removeValueDotMap","isDot#"+this.currentUsername+"#"+t.username),this.$refs.chatDiv.scrollTop=this.$refs.chatDiv.scrollHeight)},loadHrs:function(){var t=this,e=this;e.hrs=[],Object(r["f"])().then((function(e){t.hrs=e.data})),this.$store.dispatch("char/content"),Object(r["p"])().then((function(e){null!=e.data&&(e.data.map((function(e){console.info(e);var i=t.$store.getters.username+"#"+e.from,s=window.localStorage.getItem(i);if(null==s)s=[],s.push(e),window.localStorage.setItem(i,JSON.stringify(s));else{var n=JSON.parse(s);n.push(e),window.localStorage.setItem(i,JSON.stringify(n))}e.from!=t.currentFriend.username&&t.$store.commit("char/addValue2DotMap","isDot#"+t.currentUsername+"#"+e.from)})),t.updateChatDiv())})),this.$store.commit("char/toggleNFDot",!1)}}},c=o,l=(i("89b5"),i("2877")),u=Object(l["a"])(c,s,n,!1,null,null,null);e["default"]=u.exports},"6cd9":function(t,e,i){},"89b5":function(t,e,i){"use strict";var s=i("6cd9"),n=i.n(s);n.a},a2a0:function(t,e,i){},ecea:function(t,e,i){"use strict";var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"comment-wrap"},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.content,expression:"content"}],staticClass:"comment-input",attrs:{placeholder:"请输入内容",id:"textpanel"},domProps:{value:t.content},on:{input:function(e){e.target.composing||(t.content=e.target.value)}}}),t._v(" "),i("div",{staticClass:"opration"},[i("div",{staticClass:"emoji-panel-btn",on:{click:t.showEmojiPanel}},[i("img",{attrs:{src:"/face_logo.png"}})]),t._v(" "),i("div",{staticClass:"comment-send-btn comment-send-btn-bounce",on:{click:t.saveComment}},[t._v("发表评论")]),t._v(" "),t.isShowEmojiPanel?i("emoji-panel",{on:{emojiClick:t.appendEmoji}}):t._e()],1)])},n=[],r=(i("a481"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"emoji-panel-wrap"},t._l(t.emojis,(function(e,s){return i("emoji",{key:s,attrs:{text:e},on:{onClick:t.handleEmojiClick}})})),1)}),a=[],o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",{staticClass:"emoji-item-common",class:["emoji-"+t.text,t.isInput?"emoji-size-small":"emoji-size-large"],on:{click:t.emojiClick}})},c=[],l={data:function(){return{}},components:{},props:["text","isInput"],methods:{emojiClick:function(){this.$emit("onClick",this.text)}}},u=l,m=i("2877"),d=Object(m["a"])(u,o,c,!1,null,null,null),h=d.exports,p={data:function(){return{emojis:["angry","anguished","astonished","blush","cold_sweat","confounded","confused","cry","disappointed","disappointed_relieved","dizzy_face","expressionless","fearful","flushed","frowning","grimacing","grin","grinning","heart_eyes","hushed","innocent","joy","kissing_closed_eyes","kissing_heart","laughing","neutral_face","no_mouth","open_mouth","pensive","persevere","relaxed","relieved","sleepy","smile","smiley","smirk","sob","stuck_out_tongue","sunglasses","sweat","sweat_smile","scream","wink","unamused","satisfied","worried","stuck_out_tongue_closed_eyes","weary","yum","tired_face","triumph","stuck_out_tongue_winking_eye"]}},components:{Emoji:h},methods:{handleEmojiClick:function(t){this.$emit("emojiClick",t)}}},g=p,f=(i("374e"),Object(m["a"])(g,r,a,!1,null,"e9437e72",null)),v=f.exports,x={data:function(){return{content:"",flag:!1,isShowEmojiPanel:!1}},watch:{},components:{EmojiPanel:v},computed:{value:function(){this.$emit("input",this.content)}},methods:{saveComment:function(){var t=this.content.replace(/:.*?:/g,this.emoji);this.content=t,this.$emit("input",this.content),this.$emit("testEmit"),this.isShowEmojiPanel=!1,this.content="",this.$emit("input",this.content)},showEmojiPanel:function(){this.isShowEmojiPanel=!this.isShowEmojiPanel},emoji:function(t){var e=t.substring(1,t.length-1);return'<span class="emoji-item-common emoji-'.concat(e,' emoji-size-small" ></span>')},appendEmoji:function(t){var e=document.getElementById("textpanel");this.content=e.value+":"+t+":"}}},_=x,y=(i("4b8d"),Object(m["a"])(_,s,n,!1,null,null,null));e["a"]=y.exports}}]);