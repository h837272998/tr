(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7b667db5"],{9961:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"app-container"},[a("Mallki",{attrs:{text:t.$store.getters.name}}),t._v(" "),a("h3",[t._v("我的评论")]),t._v(" "),a("div",[0===t.query.total?a("el-link",[t._v("暂无评论")]):t._e(),t._v(" "),a("el-collapse",{staticClass:"el-collapse-discuss",attrs:{accordion:""},on:{change:t.handleChange}},t._l(t.list,(function(e){return a("el-collapse-item",{attrs:{name:e.id}},[a("template",{slot:"title"},[a("el-link",[t._v("\n                "+t._s(e.articleTitle)+"\n                "),e.notifyNumber>0?a("el-badge",{staticClass:"item",attrs:{value:e.notifyNumber,max:99}}):t._e()],1),t._v(" "),a("div",{staticStyle:{margin:"0 0 0 auto"}},[a("el-link",{staticStyle:{"font-size":"10px"},attrs:{icon:"el-icon-chat-dot-square",underline:!1}},[t._v(t._s(e.discussNumber))]),t._v(" "),a("el-link",{staticStyle:{"font-size":"10px"},attrs:{icon:"el-icon-view",underline:!1}},[t._v(t._s(e.clickNumber))])],1)],1),t._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.divLoading,expression:"divLoading"}],staticStyle:{"min-height":"50px"},attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0,0, 0, 0.8)"}},[a("el-table",{staticStyle:{width:"100%"},attrs:{fit:"",data:t.underList,stripe:"","header-row-class-name":"tableHead",border:""}},[a("template",{slot:"empty"},[t._v("\n                没有未读评论！\n                "),a("el-link",{attrs:{href:"/article/"+e.id,target:"_blank"}},[t._v(" 查看原文")])],1),t._v(" "),a("el-table-column",{attrs:{prop:"username",width:"120px",label:"用户"}}),t._v(" "),a("el-table-column",{attrs:{label:"内容"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("span",{staticClass:"reply-content",domProps:{innerHTML:t._s(n.content)}}),t._v(" "),n.to?a("span",{staticClass:"reply-content"},[a("span",{staticStyle:{color:"lightskyblue","font-weight":"bold"}},[t._v("回复我的")]),t._v(" "),a("span",{domProps:{innerHTML:t._s(n.to)}})]):t._e()]}}],null,!0)}),t._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"回复时间",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"floor",label:"楼层",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作",width:"250"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("el-link",{attrs:{type:"success",size:"mini"},on:{click:function(e){return t.handleDeleteNotify(n)}}},[t._v("删除通知")]),t._v(" \n"),t._v(" "),a("el-link",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.generateUrl(n)}}},[t._v("跳转\n                  ")]),t._v(" \n                  "),a("el-link",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.handleQuickReply(n)}}},[t._v("快速回复")])]}}],null,!0)})],2),t._v(" "),t.underQuery.total>0?a("el-pagination",{staticStyle:{float:"right"},attrs:{background:"","page-count":t.underQuery.total,total:t.underQuery.total,"page-size":10,"current-page":t.underQuery.current,layout:"total, prev, pager, next, jumper",small:""},on:{"update:currentPage":function(e){return t.$set(t.underQuery,"current",e)},"update:current-page":function(e){return t.$set(t.underQuery,"current",e)},"current-change":t.handCurrentChangeUnder}}):t._e()],1)],2)})),1)],1),t._v(" "),t.query.total>0?a("el-pagination",{staticStyle:{float:"right","margin-top":"10px"},attrs:{background:"","current-page":t.query.page,"page-size":20,total:t.query.total,"prev-text":"上一页","next-text":"下一页",layout:"prev, pager, next, jumper"},on:{"update:currentPage":function(e){return t.$set(t.query,"page",e)},"update:current-page":function(e){return t.$set(t.query,"page",e)},"current-change":t.handCurrentChange}}):t._e(),t._v(" "),a("el-dialog",{attrs:{title:"快速回复",visible:t.dialogVisible,width:"30%",center:""},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-input",{model:{value:t.quickReply,callback:function(e){t.quickReply=e},expression:"quickReply"}}),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.handleSumbitReply}},[t._v("确 定")])],1)],1)],1)},i=[],r=a("137c"),l=a("2423"),o={name:"index",components:{Mallki:r["a"]},data:function(){return{loading:!1,list:[],divLoading:!1,query:{page:1,limit:10,total:0},underList:[],underQuery:{current:1,username:this.$store.getters.username,total:0},dialogVisible:!1,quickReply:"",dialogData:{},activeNumber:""}},created:function(){this.get()},methods:{get:function(){var t=this;Object(l["z"])(this.query).then((function(e){t.list=e.data.records,t.query.total=e.data.total}))},handleChange:function(t){var e=this;this.divLoading=!0,t&&(this.activeNumber=t,Object(l["p"])(t,this.underQuery).then((function(t){e.underList=t.data.records,e.underQuery.total=t.data.total,e.underQuery.current=t.data.current,e.divLoading=!1})))},handCurrentChange:function(t){this.query.page=t,this.get()},handCurrentChangeUnder:function(t){this.underQuery.current=t,this.handleChange(this.activeNumber)},handleDeleteNotify:function(t){var e=this;Object(l["g"])(t.discussId).then((function(a){a.data&&e.handleChange(t.articleId)}))},handleQuickReply:function(t){this.dialogVisible=!0,this.dialogData=t},handleSumbitReply:function(){var t=this,e="";e="-1"===this.dialogData.topParentId||-1===this.dialogData.topParentId?this.dialogData.discussId:this.dialogData.topParentId;var a={content:this.quickReply,parentId:this.dialogData.discussId,topParentId:e};Object(l["d"])(this.dialogData.articleId,a).then((function(e){t.$notify({type:"success",title:"评论成功！"}),t.quickReply="",t.dialogVisible=!1,t.handleDeleteNotify(t.dialogData)})).catch((function(e){t.$notify({type:"error",title:"评论失败"}),t.dialogVisible=!1}))},generateUrl:function(t){var e=this;if(console.info(t),t.to)Object(l["n"])(t.topParentId).then((function(a){if(a.data){var n="/article/".concat(t.articleId,"?page=").concat(Math.ceil(t.floor/10),"&jump=").concat(a.data,"&jump_under=").concat(a.floor),i=e.$router.resolve({path:n});window.open(i.href,"_blank")}}));else{var a="/article/".concat(t.articleId,"?page=").concat(Math.ceil(t.floor/10),"&jump=").concat(t.floor),n=this.$router.resolve({path:a});window.open(n.href,"_blank")}}}},s=o,c=(a("c501"),a("2877")),u=Object(c["a"])(s,n,i,!1,null,null,null);e["default"]=u.exports},afb7:function(t,e,a){},c501:function(t,e,a){"use strict";var n=a("afb7"),i=a.n(n);i.a}}]);